name: Upload website files to S3 Bucket

on:
  push:
    branches: ["main"]

jobs:
  upload_to_s3:
    name: Deploy website files to S3 Bucket
    runs-on: ubuntu-latest
    env:
      AWS_ACCESS_KEY_ID: ${{ secrets.AWS_KEY_ID }}
      AWS_SECRET_ACCESS_KEY: ${{ secrets.AWS_SECRET_ACCESS_KEY}}
      AWS_DEFAULT_REGION: 'us-east-1'
    steps:
      - name: Checkout
        uses: actions/checkout@v3
      - name: Upload to S3
        uses: lbertenasco/s3-deploy@v1.2.4
        with:
          folder: 'webpage'
          bucket: ${{ secrets.AWS_BUCKET }}
          dist-id: ${{ secrets.CLOUDFRONT_DISTRIBUTION_ID }}
          invalidation: / *
